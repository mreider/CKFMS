groups:
  - id: vulnerability
    type: attribute_group
    brief: >
      Resource describing a vulnerability on either the level of a vulnerability or it's occurence on an affected entity.
    attributes:
      - id: vulnerability.id
        type: string
        stability: stable
        brief: >
          Dynatrace unique identifier for the vulnerability.
        examples: ["2039861408676243188"]
      - id: vulnerability.display_id
        type: string
        stability: stable
        brief: >
          Dynatrace user-readable identifier for the vulnerability.
        examples: ["S-1234"]
      - id: vulnerability.external_id
        type: string
        stability: stable
        brief: >
          External provider's unique identifier for the vulnerability.
        examples: ["SNYK-JAVA-ORGAPACHEHTTPCOMPONENTS-30646"]
      - id: vulnerability.type
        type: string
        stability: stable
        brief: >
          Classification of the vulnerability based on commonly accepted enums, such as CWE.
        examples: ["Improper Input Validation"]
      - id: vulnerability.stack
        type:
          allow_custom_values: true
          members:
            - id: code
              value: "CODE"
            - id: code_library
              value: "CODE_LIBRARY"
            - id: software
              value: "SOFTWARE"
            - id: container_orchestration
              value: "CONTAINER_ORCHESTRATION"
        stability: experimental
        brief: >
          Level of the vulnerable component in the technological stack.
        examples:
          ["CODE", "CODE_LIBRARY", "SOFTWARE", "CONTAINER_ORCHESTRATION"]
      - id: vulnerability.technology
        type:
          allow_custom_values: true
          members:
            - id: java
              value: "JAVA"
            - id: dotnet
              value: "DOTNET"
            - id: go
              value: "GO"
            - id: php
              value: "PHP"
            - id: node_js
              value: "NODE_JS"
        stability: stable
        brief: >
          Technology of the vulnerable component.
        examples: ["JAVA", "DOTNET", "GO", "PHP", "NODE_JS"]
      - id: vulnerability.title
        type: string
        stability: stable
        brief: >
          Title of the vulnerability.
        examples: ["Improper Input Validation"]
      - id: vulnerability.description
        type: string
        stability: stable
        brief: >
          Description of the vulnerability.
        examples:
          [
            "More detailed description about improper input validation vulnerability.",
          ]
      - id: vulnerability.url
        type: string
        stability: stable
        brief: >
          Dynatrace URL to the details page of the vulnerability. |
        examples: ["https://example.com"]
      - id: vulnerability.external_url
        type: string
        stability: stable
        brief: >
          External provider's URL to the details page of the vulnerability.
        examples: ["https://example.com"]
      - id: vulnerability.references.cve
        type: string[]
        stability: stable
        brief: >
          List of the vulnerability's CVE IDs.
        examples: ["CVE-2021-41079"]
      - id: vulnerability.references.cwe
        type: string[]
        stability: stable
        brief: >
          List of the vulnerability's CWE IDs.
        examples: ["CWE-20"]
      - id: vulnerability.references.owasp
        type: string[]
        stability: stable
        brief: >
          List of vulnerability's OWASP IDs.
        examples: ["2021:A3"]
      - id: vulnerability.tracking_link.url
        type: string
        stability: experimental
        internal: true
        brief: >
          URL of the tracking link that was set by the user.
        examples: ["https://example.com/Project1/P-1000"]
      - id: vulnerability.tracking_link.text
        type: string
        stability: experimental
        internal: true
        brief: >
          Display text of the tracking link that was set by the user.
        examples: ["P-1000 Vulnerability CVE-2024-0001"]
      - id: vulnerability.resolution.status
        type:
          allow_custom_values: true
          members:
            - id: open
              value: "OPEN"
            - id: resolved
              value: "RESOLVED"
        stability: stable
        brief: >
          Vulnerability's resolution status.
        examples: ["OPEN", "RESOLVED"]
      - id: vulnerability.resolution.change_date
        type: timestamp
        stability: stable
        brief: >
          Timestamp of the vulnerability's last resolution status change.
        examples: ["2023-03-22T13:19:37.466Z"]
      - id: vulnerability.cvss.base_score
        type: double
        stability: stable
        brief: >
          Vulnerability's CVSS base score provided by NVD.
        examples: [8.1]
      - id: vulnerability.cvss.version
        type: string
        stability: stable
        brief: >
          Vulnerability's CVSS score version.
        examples:
          - "3.1"
          - "4.0"
      - id: vulnerability.cvss.vector
        type: string
        stability: experimental
        internal: true
        brief: >
          Vulnerability's CVSS vector defined by the provider.
        examples:
          - "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:L/VA:L/SC:L/SI:L/SA:L"
          - "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:L/A:H/E:P/RL:T/RC:U/CR:L/IR:M/AR:H"
      - id: vulnerability.risk.score
        type: double
        stability: stable
        brief: >
          Vulnerability's risk score defined by the provider. For Dynatrace, Davis Security Score.
        examples: [8.1]
      - id: vulnerability.risk.level
        type:
          allow_custom_values: true
          members:
            - id: low
              value: "LOW"
            - id: medium
              value: "MEDIUM"
            - id: high
              value: "HIGH"
            - id: critical
              value: "CRITICAL"
            - id: none
              value: "NONE"
        stability: stable
        brief: >
          Vulnerability's risk score level defined by the provider. For Dynatrace, the Davis Security Score level.
        examples: ["LOW", "MEDIUM", "HIGH", "CRITICAL", "NONE"]
      - id: vulnerability.risk.scale
        type: string
        stability: stable
        brief: >
          Scale by which the vulnerability's risk score and risk score level defined by the provider are measured.
        examples: ["Davis Security Score"]
      - id: vulnerability.davis_assessment.score
        type: double
        stability: stable
        brief: >
          Vulnerability's Davis Security Score (1-10) calculated by Dynatrace.
        examples: [8.1]
      - id: vulnerability.davis_assessment.vector
        type: string
        stability: experimental
        internal: true
        brief: >
          Vulnerability's CVSS vector, adjusted with observability data; this vector is calculated by Dynatrace.
        examples:
          - "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:L/VA:L/SC:L/SI:L/SA:L"
          - "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:L/A:H/E:P/RL:T/RC:U/CR:L/IR:M/AR:H"
      - id: vulnerability.davis_assessment.level
        type:
          allow_custom_values: true
          members:
            - id: low
              value: "LOW"
            - id: medium
              value: "MEDIUM"
            - id: high
              value: "HIGH"
            - id: critical
              value: "CRITICAL"
            - id: none
              value: "NONE"
        stability: stable
        brief: >
          Vulnerability's risk level based on Davis Security Score.
        examples: ["LOW", "MEDIUM", "HIGH", "CRITICAL", "NONE"]
      - id: vulnerability.davis_assessment.exposure_status
        type:
          allow_custom_values: true
          members:
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_detected
              value: "NOT_DETECTED"
            - id: public_network
              value: "PUBLIC_NETWORK"
            - id: adjacent_network
              value: "ADJACENT_NETWORK"
        stability: stable
        brief: >
          Vulnerability's internet exposure status.
        examples:
          [
            "NOT_AVAILABLE",
            "NOT_DETECTED",
            "PUBLIC_NETWORK",
            "ADJACENT_NETWORK",
          ]
      - id: vulnerability.davis_assessment.data_assets_status
        type:
          allow_custom_values: true
          members:
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_detected
              value: "NOT_DETECTED"
            - id: reachable
              value: "REACHABLE"
        stability: stable
        brief: >
          Vulnerability's reachability of related data assets by affected entities.
        examples: ["NOT_AVAILABLE", "NOT_DETECTED", "REACHABLE"]
      - id: vulnerability.davis_assessment.assessment_mode
        type:
          allow_custom_values: true
          members:
            - id: full
              value: "FULL"
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: reduced
              value: "REDUCED"
        stability: stable
        brief: >
          Availability of the information based on which the vulnerability assessment has been done.
        examples: ["FULL", "NOT_AVAILABLE", "REDUCED"]
      - id: vulnerability.davis_assessment.assessment_mode_reasons
        type: string[]
        stability: experimental
        brief: >
          Reasons for the assessment mode.
        examples: ["LIMITED_BY_CONFIGURATION", "LIMITED_AGENT_SUPPORT"]
      - id: vulnerability.davis_assessment.exploit_status
        type:
          allow_custom_values: true
          members:
            - id: available
              value: "AVAILABLE"
            - id: not_available
              value: "NOT_AVAILABLE"
        stability: stable
        brief: >
          Vulnerability's public exploits status.
        examples: ["AVAILABLE", "NOT_AVAILABLE"]
      - id: vulnerability.davis_assessment.vulnerable_function_status
        stability: stable
        type:
          allow_custom_values: true
          members:
            - id: in_use
              value: "IN_USE"
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_in_use
              value: "NOT_IN_USE"
        brief: >
          Usage status of the vulnerable functions causing the vulnerability.
        examples: ["IN_USE", "NOT_AVAILABLE", "NOT_IN_USE"]
      - id: vulnerability.first_seen
        type: timestamp
        stability: stable
        brief: >
          Timestamp of when the vulnerability was first detected.
        examples: ["2023-03-22T13:19:36.945Z"]
      - id: vulnerability.parent.resolution.status
        type:
          allow_custom_values: true
          members:
            - id: open
              value: "OPEN"
            - id: resolved
              value: "RESOLVED"
        stability: stable
        brief: >
          Current status of the vulnerability.
        examples: ["OPEN", "RESOLVED"]
      - id: vulnerability.parent.resolution.change_date
        type: string
        stability: stable
        brief: >
          Timestamp of the vulnerability's last resolution status change.
        examples: ["2023-03-22T13:19:37.466Z"]
      - id: vulnerability.parent.risk.score
        type: double
        stability: stable
        brief: >
          Vulnerability's risk score defined by the provider. For Dynatrace, Davis Security Score.
        examples: [8.1]
      - id: vulnerability.parent.risk.level
        type:
          allow_custom_values: true
          members:
            - id: low
              value: "LOW"
            - id: medium
              value: "MEDIUM"
            - id: high
              value: "HIGH"
            - id: critical
              value: "CRITICAL"
            - id: none
              value: "NONE"
        stability: stable
        brief: >
          Vulnerability's risk score level defined by the provider. For Dynatrace, the Davis Security Score level.
        examples: ["LOW", "MEDIUM", "HIGH", "CRITICAL", "NONE"]
      - id: vulnerability.parent.davis_assessment.score
        type: double
        stability: stable
        brief: >
          Vulnerability's Davis Security Score (1-10) calculated by Dynatrace.
        examples: [8.1]
      - id: vulnerability.parent.davis_assessment.level
        type:
          allow_custom_values: true
          members:
            - id: low
              value: "LOW"
            - id: medium
              value: "MEDIUM"
            - id: high
              value: "HIGH"
            - id: critical
              value: "CRITICAL"
            - id: none
              value: "NONE"
        stability: stable
        brief: >
          Vulnerability's Davis Security Score level.
        examples: ["LOW", "MEDIUM", "HIGH", "CRITICAL", "NONE"]
      - id: vulnerability.parent.davis_assessment.exposure_status
        type:
          allow_custom_values: true
          members:
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_detected
              value: "NOT_DETECTED"
            - id: public_network
              value: "PUBLIC_NETWORK"
            - id: adjacent_network
              value: "ADJACENT_NETWORK"
        stability: stable
        brief: >
          Vulnerability's internet exposure status.
        examples:
          [
            "NOT_AVAILABLE",
            "NOT_DETECTED",
            "PUBLIC_NETWORK",
            "ADJACENT_NETWORK",
          ]
      - id: vulnerability.parent.davis_assessment.data_assets_status
        type:
          allow_custom_values: true
          members:
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_detected
              value: "NOT_DETECTED"
            - id: reachable
              value: "REACHABLE"
        stability: stable
        brief: >
          Vulnerability's reachability of related data assets by affected entities.
        examples: ["NOT_AVAILABLE", "NOT_DETECTED", "REACHABLE"]
      - id: vulnerability.parent.davis_assessment.assessment_mode
        type:
          allow_custom_values: true
          members:
            - id: full
              value: "FULL"
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: reduced
              value: "REDUCED"
        stability: stable
        brief: >
          Availability of the information based on which the vulnerability assessment has been done.
        examples: ["FULL", "NOT_AVAILABLE", "REDUCED"]
      - id: vulnerability.parent.davis_assessment.vulnerable_function_status
        type:
          allow_custom_values: true
          members:
            - id: in_use
              value: "IN_USE"
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_in_use
              value: "NOT_IN_USE"
        stability: stable
        brief: >
          Usage status of vulnerable functions causing the vulnerability. Status is `IN_USE` when there's at least one vulnerable function in use by an application.
        examples: ["IN_USE", "NOT_AVAILABLE", "NOT_IN_USE"]
      - id: vulnerability.parent.first_seen
        type: string
        stability: stable
        brief: >
          Timestamp of when the vulnerability was first detected.
        examples: ["2023-03-22T13:19:36.945Z"]
      - id: vulnerability.parent.mute.status
        type:
          allow_custom_values: true
          members:
            - id: muted
              value: "MUTED"
            - id: not_muted
              value: "NOT_MUTED"
        stability: stable
        brief: >
          Vulnerability's mute status.
        examples: ["MUTED", "NOT_MUTED"]
      - id: vulnerability.mute.status
        type:
          allow_custom_values: true
          members:
            - id: muted
              value: "MUTED"
            - id: not_muted
              value: "NOT_MUTED"
        stability: stable
        brief: >
          Vulnerability's mute status.
        examples: ["MUTED", "NOT_MUTED"]
      - id: vulnerability.mute.user
        type: string
        stability: stable
        brief: >
          User who last changed the vulnerability's mute status.
        examples: ["user@example.com"]
      - id: vulnerability.parent.mute.user
        type: string
        stability: stable
        brief: >
          User who last changed the vulnerability's mute status.
        examples: ["user@example.com"]
      - id: vulnerability.mute.reason
        type:
          allow_custom_values: true
          members:
            - id: false_positive
              value: "FALSE_POSITIVE"
            - id: ignore
              value: "IGNORE"
            - id: affected
              value: "AFFECTED"
            - id: configuration_not_affected
              value: "CONFIGURATION_NOT_AFFECTED"
            - id: other
              value: "OTHER"
        stability: stable
        brief: >
          Reason for muting or unmuting the vulnerability.
        examples:
          [
            "FALSE_POSITIVE",
            "IGNORE",
            "AFFECTED",
            "CONFIGURATION_NOT_AFFECTED",
            "OTHER",
          ]
      - id: vulnerability.parent.mute.reason
        type:
          allow_custom_values: true
          members:
            - id: false_positive
              value: "FALSE_POSITIVE"
            - id: ignore
              value: "IGNORE"
            - id: affected
              value: "AFFECTED"
            - id: configuration_not_affected
              value: "CONFIGURATION_NOT_AFFECTED"
            - id: other
              value: "OTHER"
        stability: stable
        brief: >
          Reason for muting or unmuting the vulnerability.
        examples:
          [
            "FALSE_POSITIVE",
            "IGNORE",
            "AFFECTED",
            "CONFIGURATION_NOT_AFFECTED",
            "OTHER",
          ]
      - id: vulnerability.mute.change_date
        type: timestamp
        stability: stable
        brief: >
          Timestamp of the vulnerability's last muted or unmuted action.
        examples: ["2023-03-22T13:19:36.945Z"]
      - id: vulnerability.parent.mute.change_date
        type: timestamp
        stability: stable
        brief: >
          Timestamp of the last mute or unmute action of the vulnerability.
        examples: ["2023-03-22T13:19:36.945Z"]
      - id: vulnerability.mute.comment
        type: string
        stability: experimental
        brief: >
          Comment when muting or unmuting the vulnerability.
        examples: ["Muted because it's a false positive."]
      - id: vulnerability.previous.risk.score
        type: double
        stability: stable
        brief: >
          Vulnerability's previous risk score (in case the risk score has changed).
        examples: [8.1]
      - id: vulnerability.previous.risk.level
        type:
          allow_custom_values: true
          members:
            - id: low
              value: "LOW"
            - id: medium
              value: "MEDIUM"
            - id: high
              value: "HIGH"
            - id: critical
              value: "CRITICAL"
            - id: none
              value: "NONE"
        stability: stable
        brief: >
          Vulnerability's previous risk score level (in case the risk score level has changed).
        examples: ["LOW", "MEDIUM", "HIGH", "CRITICAL"]
      - id: vulnerability.previous.cvss.base_score
        type: double
        stability: stable
        brief: >
          Vulnerability's previous CVSS base score (in case the CVSS base score has changed).
        examples: [8.1]
      - id: vulnerability.previous.cvss.vector
        type: string
        stability: experimental
        internal: true
        brief: >
          Vulnerability's previous CVSS vector defined by the provider (in case the CVSS vector has changed).
        examples:
          - "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:L/VA:L/SC:L/SI:L/SA:L"
          - "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:L/A:H/E:P/RL:T/RC:U/CR:L/IR:M/AR:H"
      - id: vulnerability.previous.davis_assessment.score
        type: double
        stability: stable
        brief: >
          Vulnerability's previous Davis Security Score (in case Davis Security Score has changed).
        examples: [8.1]
      - id: vulnerability.previous.davis_assessment.level
        type:
          allow_custom_values: true
          members:
            - id: low
              value: "LOW"
            - id: medium
              value: "MEDIUM"
            - id: high
              value: "HIGH"
            - id: critical
              value: "CRITICAL"
            - id: none
              value: "NONE"
        stability: stable
        brief: >
          Vulnerability's previous risk level (in case the risk level has changed).
        examples: ["LOW", "MEDIUM", "HIGH", "CRITICAL", "NONE"]
      - id: vulnerability.previous.davis_assessment.exploit_status
        type:
          allow_custom_values: true
          members:
            - id: available
              value: "AVAILABLE"
            - id: not_available
              value: "NOT_AVAILABLE"
        stability: stable
        brief: >
          Vulnerability's previous public exploit status (in case the public exploit status has changed).
        examples: ["AVAILABLE", "NOT_AVAILABLE"]
      - id: vulnerability.previous.davis_assessment.exposure_status
        type:
          allow_custom_values: true
          members:
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_detected
              value: "NOT_DETECTED"
            - id: public_network
              value: "PUBLIC_NETWORK"
            - id: adjacent_network
              value: "ADJACENT_NETWORK"
        stability: stable
        brief: >
          Vulnerability's previous internet exposure status (in case the internet exposure status has changed).
        examples:
          [
            "NOT_AVAILABLE",
            "NOT_DETECTED",
            "PUBLIC_NETWORK",
            "ADJACENT_NETWORK",
          ]
      - id: vulnerability.previous.davis_assessment.data_assets_status
        type:
          allow_custom_values: true
          members:
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_detected
              value: "NOT_DETECTED"
            - id: reachable
              value: "REACHABLE"
        stability: stable
        brief: >
          Vulnerability's previous reachability of related data assets by affected entities (in case the reachability has changed).
        examples: ["NOT_AVAILABLE", "NOT_DETECTED", "REACHABLE"]
      - id: vulnerability.previous.davis_assessment.vulnerable_function_status
        type:
          allow_custom_values: true
          members:
            - id: in_use
              value: "IN_USE"
            - id: not_available
              value: "NOT_AVAILABLE"
            - id: not_in_use
              value: "NOT_IN_USE"
        stability: stable
        brief: >
          Vulnerability's previous vulnerable function status (in case the vulnerable function status has changed).
        examples: ["IN_USE", "NOT_AVAILABLE", "NOT_IN_USE"]
      - id: vulnerability.previous.mute.status
        type:
          allow_custom_values: true
          members:
            - id: muted
              value: "MUTED"
            - id: not_muted
              value: "NOT_MUTED"
        stability: stable
        brief: >
          Vulnerability's previous mute status (in case the mute status has changed).
        examples: ["MUTED", "NOT_MUTED"]
      - id: vulnerability.previous.mute.user
        type: string
        stability: stable
        brief: >
          User who last changed the vulnerability's mute status (in case the mute status was last changed by a different user).
        examples: ["user@example.com"]
      - id: vulnerability.previous.mute.reason
        type: string
        stability: stable
        brief: >
          Reason for last muting or unmuting the vulnerability (in case the reason for muting or unmuting the vulnerability has changed).
        examples: ["Muted: False positive"]
      - id: vulnerability.previous.mute.change_date
        type: string
        stability: stable
        brief: >
          Timestamp of the vulnerability's previous mute status (in case the mute status has changed).
        examples: ["2023-03-22T13:19:36.945Z"]
      - id: vulnerability.previous.mute.comment
        type: string
        stability: experimental
        brief: >
          Comment of the vulnerability's previous mute status.
        examples: ["Muted because it's a false positive."]
      - id: vulnerability.previous.tracking_link.url
        type: string
        stability: experimental
        internal: true
        brief: >
          URL of the previous tracking link that was set by the user.
        examples: ["https://example.com/Project1/P-1000"]
      - id: vulnerability.previous.tracking_link.text
        type: string
        stability: experimental
        internal: true
        brief: >
          Display text of the previous tracking link that was set by the user.
        examples: ["P-1000 Vulnerability CVE-2024-0001"]
      - id: vulnerability.previous.resolution.status
        type:
          allow_custom_values: true
          members:
            - id: open
              value: "OPEN"
            - id: resolved
              value: "RESOLVED"
        stability: stable
        brief: >
          Vulnerability's previous resolution status (in case the resolution status has changed).
        examples: ["OPEN", "RESOLVED"]
      - id: vulnerability.code_location.name
        type: string
        stability: stable
        brief: >
          Name of the code location where the code-level vulnerability was detected.
        examples:
          [
            "org.dynatrace.profileservice.BioController.markdownToHtml(String):80",
          ]
      - id: vulnerability.remediation.description
        type: string
        stability: experimental
        brief: >
          Description of the vulnerability's remediation advice.
        examples: ["Upgrade component to version 1.2.3 or higher"]
      - id: vulnerability.remediation.status
        type: string
        stability: experimental
        brief: >
          Indicates whether a fix for the vulnerability is available.
        examples: ["AVAILABLE", "NOT_AVAILABLE"]
      - id: vulnerability.exploit.status
        type: string
        stability: experimental
        brief: >
          Whether there is a known exploit for the vulnerability.
        examples: ["AVAILABLE", "NOT_AVAILABLE"]
      - id: vulnerability.is_fix_available
        type: boolean
        stability: experimental
        brief: >
          Indicates if a vulnerability fix is available.
      - id: vulnerability.last_confirmed
        type: timestamp
        stability: experimental
        internal: true
        brief: >
          Timestamp of the vulnerability's last confirmation date.
      - id: vulnerability.vulnerable_components
        type: record[]
        stability: experimental
        internal: true
        brief: >
          A collection of vulnerable components.
        examples:
          [
            [
              {
                "vulnerable_component.id": "SOFTWARE_COMPONENT-123456789",
                "vulnerable_component.name": "sqlite3:3.16.2-5+deb9u3",
                "vulnerable_component.short_name": "sqlite3",
                "vulnerable_component.version": "3.16.2-5+deb9u3",
                "vulnerable_component.package_name": "sqlite"
              },
            ],
          ]
